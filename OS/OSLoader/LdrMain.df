//
// Implements the generic part of the MINTIA bootloader.
//

#include "<df>/dragonfruit.h"

#include "OSLoader.h"

fn LdrMain { -- ret }
	0 ret!

	LOADERMINOR
	LOADERMAJOR
	"\nMINTIA OSLoader %d.%d\n" Printf

	LdrMemoryInit

	LdrIOInit

	"hi\n" Printf
end

fn LdrCrash { ... fmt -- }
	"\n*** The boot process encountered a fatal error:\n" Printf

	argv argc@ fmt@ VPrintf

	"\n" Printf

	-1 LdrExit
end

fn LdrExit { ret -- }
	ret@ LdrPlatformExit
end