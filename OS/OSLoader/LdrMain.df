//
// Implements the generic part of the MINTIA bootloader.
//

#include "<df>/dragonfruit.h"

#include "OSLoader.h"

fn LdrMain { args -- ret }
	0 ret!

	LOADERMINOR
	LOADERMAJOR
	"MINTIA OSLoader %d.%d\n" Printf

	LdrMemoryInit

	"hi\n" Printf
end

fn LdrPanic { ... fmt -- }
	"*** The boot process encountered a fatal error.\n" Printf

	argv argc@ fmt@ VPrintf

	-1 LdrExit
end

fn LdrExit { ret -- }
	ret@ LdrPlatformExit
end