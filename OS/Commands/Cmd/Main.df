#include "<df>/dragonfruit.h"

#include "<ll>/OSDLL/OS.h"

buffer ParseBuffer 2048

fn Main { ... -- ret }
	auto pwd
	auto ok

	while (1)
		"PWD"
		OSFindEnvironmentVariable ok! pwd! drop

		if (ok@)
			"?" pwd!
		end

		pwd@ "%s # " Printf

		if (ParseBuffer 2048 OSReadline)
			0 OSExit
		end

		if (ParseBuffer "cd " 3 strncmp)
			ParseBuffer 3 + OSChangeCWD ok!

			if (ok@)
				ok@ OSStatusGetName "cmd: failed to cd: %s\n" Printf
			end
		end

		"cmd: i dont do anything yet\n" Printf
	end
end